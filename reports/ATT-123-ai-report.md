# QA Report - Partial

The LLM response was invalid JSON (likely unescaped quotes in generated code).

Raw LLM response:

```
{
  "reportMarkdown": "# QA Test Report for ATT-123: Mark Batch Attendance API\n\n## Overview\nThis suite tests the `/api/attendance/batch` endpoint, focusing on business rules, API contract, and critical edge and error scenarios as specified.\n\n## Coverage\n- **Positive**: Standard marking, large batch, duplicate IDs with consistent/inconsistent presence.\n- **Negative**: Invalid/empty input, subject ownership, date in future, invalid students.\n- **Validation**: Only active students, subject-faculty check, entry constraints.\n\n## Test Classes & Methods\n\n### `AttendanceBatchControllerTest`\n1. **testMarkBatchAttendance_ValidRequest_Returns200** — Standard successful batch marking.\n2. **testMarkBatchAttendance_LargeBatch_Returns200** — Large batch of 500 students.\n3. **testMarkBatchAttendance_DuplicateStudentIds_IgnoresOrFailsAsPerSpec** — Duplicate IDs (if API ignores or fails).\n4. **testMarkBatchAttendance_InvalidSubject_Returns404** — Subject does not exist.\n5. **testMarkBatchAttendance_SubjectNotBelongToFaculty_Returns404** — Subject exists but is not owned by faculty.\n6. **testMarkBatchAttendance_EntriesEmpty_Returns400EmptyBatch** — Entries array empty.\n7. **testMarkBatchAttendance_AttendanceDateInFuture_Returns400** — Date in the future.\n8. **testMarkBatchAttendance_InactiveOrInvalidStudents_Reported** — Some student IDs inactive/invalid, reported in `invalidStudentIds`.\n\n\n### `AttendanceBatchValidationTest`\n1. **testMarkBatchAttendance_MissingRequiredFields_Returns400** — Request missing date or subjectId.\n2. **testMarkBatchAttendance_InvalidDateFormat_Returns400** — Date is not in `YYYY-MM-DD` format.\n\n\n## Assumptions\n- Auth is handled elsewhere (faculty user context present).\n- Duplicate student IDs are either deduplicated or treated as invalid by the API, verified in test.\n- All business rules, including subject ownership and student status, are enforced at API/service layer.\n",
  "tests": [
    {
      "className": "AttendanceBatchControllerTest",
      "javaCode": "import static org.mockito.Mockito.*;\nimport static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;\nimport org.junit.jupiter.api.Test;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\nimport org.springframework.http.MediaType;\nimport org.springframework.test.web.servlet.MockMvc;\n\n@WebMvcTest\npublic class AttendanceBatchControllerTest {\n  @Autowired\n  MockMvc mockMvc;\n\n  @Test\n  void testMarkBatchAttendance_ValidRequest_Returns200() throws Exception {\n    String json = \"{\" +\n        \"\\\"date\\\":\\\"2024-05-21\\\",\\\"subjectId\\\":\\\"SUBJ123\\\",\\\"entries\\\":[{\" +\n        \"\\\"studentId\\\":\\\"ST1\\\",\\\"present\\\":true},{\\\"studentId\\\":\\\"ST2\\\",\\\"present\\\":false}]}\";\n    mockMvc.perform(post(\"/api/attendance/batch\")\n        .contentType(MediaType.APPLICATION_JSON).content(json))\n      .andExpect(status().isOk())\n      .andExpect(jsonPath(\"$.total\").value(2))\n      .andExpect(jsonPath(\"$.marked\").value(2))\n      .andExpect(jsonPath(\"$.invalidStudentIds\").isEmpty());\n  }\n\n  @Test\n  void testMarkBatchAttendance_LargeBatch_Returns200() throws Exception {\n    StringBuilder entries = new StringBuilder();\n    for(int i=0;i<500;i++) {\n      entries.append(String.format(\"{\\\"studentId\\\":\\\"STU%d\\\",\\\"present\\\":%s}\", i, (i%2==0)));\n      if(i<499) entries.append(\",\");\n    }\n    String json = String.format(\"{\\\"date\\\":\\\"2024-05-21\\\",\\\"subjectId\\\":\\\"SUBJ123\\\",\\\"entries\\\":[%s]}\", entries);\n    mockMvc.perform(post(\"/api/attendance/batch\")\n        .contentType(MediaType.APPLICATION_JSON).content(json))\n      .andExpect(status().isOk())\n      .andExpect(jsonPath(\"$.total\").value(500))\n      .andExpect(jsonPath(\"$.marked\").value(500));\n  }\n\n  @Test\n  void testMarkBatchAttendance_DuplicateStudentIds_IgnoresOrFailsAsPerSpec() throws Exception {\n    String json = \"{\" +\n        \"\\\"date\\\":\\\"2024-05-21\\\",\\\"subjectId\\\":\\\"SUBJ123\\\",\\\"entries\\\":[{\" +\n        \"\\\"studentId\\\":\\\"ST1\\\",\\\"present\\\":true},{\\\"studentId\\\":\\\"ST1\\\",\\\"present\\\":false}]}\";\n    mockMvc.perform(post(\"/api/attendance/batch\")\n        .contentType(MediaType.APPLICATION_JSON).content(json))\n      .andExpect(status().isOk())\n      .andExpect(jsonPath(\"$.total\").value(2))\n      .andExpect(jsonPath(\"$.marked\").value(1));\n  }\n\n  @Test\n  void testMarkBatchAttendance_InvalidSubject_Returns404() throws Exception {\n    String json = \"{\" +\n        \"\\\"date\\\":\\\"2024-05-21\\\",\\\"subjectId\\\":\\\"INVALID\\\",\\\"entries\\\":[{\" +\n        \"\\\"studentId\\\":\\\"ST1\\\",\\\"present\\\":true}]}\";\n    mockMvc.perform(post(\"/api/attendance/batch\")\n        .contentType(MediaType.APPLICATION_JSON).content(json))\n      .andExpect(status().isNotFound())\n      .andExpect(jsonPath(\"$.code\").value(\"SUBJECT_NOT_FOUND\"));\n  }\n\n  @Test\n  void testMarkBatchAttendance_SubjectNotBelongToFaculty_Returns404() throws Exception {\n    String json = \"{\" +\n        \"\\\"date\\\":\\\"2024-05-21\\\",\\\"subjectId\\\":\\\"SUBJ_OTHER\\\",\\\"entries\\\":[{\" +\n        \"\\\"studentId\\\":\\\"ST1\\\",\\\"present\\\":true}]}\";\n    mockMvc.perform(post(\"/api/attendance/batch\")\n        .contentType(MediaType.APPLICATION_JSON).content(json))\n      .andExpect(status().isNotFound())\n      .andExpect(jsonPath(\"$.code\").value(\"SUBJECT_NOT_FOUND\"));\n  }\n\n  @Test\n  void testMarkBatchAttendance_EntriesEmpty_Returns400EmptyBatch() throws Exception {\n    String json = \"{\" +\n        \"\\\"date\\\":\\\"2024-05-21\\\",\\\"subjectId\\\":\\\"SUBJ1\\\",\\\"entries\\\":[]}\";\n    mockMvc.perform(post(\"/api/attendance/batch\")\n        .contentType(MediaType.APPLICATION_JSON).content(json))\n      .andExpect(status().isBadRequest())\n      .andExpect(jsonPath(\"$.code\").value(\"EMPTY_BATCH\"));\n  }\n\n  @Test\n  void testMarkBatchAttendance_AttendanceDateInFuture_Returns400() throws Exception {\n    String futureDate = java.time.LocalDate.now().plusDays(1).toString();\n    String json = String.format(\"{\\\"date\\\":\\\"%s\\\",\\\"subjectId\\\":\\\"SUBJ1\\\",\\\"entries\\\":[{\\\"studentId\\\":\\\"ST1\\\",\\\"present\\\":true}]}\", futureDate);\n    mockMvc.perform(post(\"/api/attendance/batch\")\n        .contentType(MediaType.APPLICATION_JSON).content(json))\n      .andExpect(status().isBadRequest());\n  }\n\n  @Test\n  void testMarkBatchAttendance_InactiveOrInvalidStudents_Reported() throws Exception {\n    String json = \"{\" +\n        \"\\\"date\\\":\\\"2024-05-21\\\",\\\"subjectId\\\":\\\"SUBJ1\\\",\\\"entries\\\":[{\" +\n        \"\\\"studentId\\\":\\\"ACTIVE1\\\",\\\"present\\\":true},{\\\"studentId\\\":\\\"INACTIVE1\\\",\\\"present\\\":false},{\\\"studentId\\\":\\\"INVALID\\\",\\\"present\\\":false}]}\";\n    mockMvc.perform(post(\"/api/attendance/batch\")\n        .contentType(MediaType.APPLICATION_JSON).content(json))\n      .andExpect(status().isOk())\n      .andExpect(jsonPath(\"$.invalidStudentIds\").isArray())\n      .andExpect(jsonPath(\"$.invalidStudentIds[0]\").value(\"INACTIVE1\"))\n      .andExpect(jsonPath(\"$.invalidStudentIds[1]\").value(\"INVALID\"));\n  }\n}\n"
    },
    {
      "className": "AttendanceBatchValidationTest",
      "javaCode": "import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;\nimport org.junit.jupiter.api.Test;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\nimport org.springframework.http.MediaType;\nimport org.springframework.test.web.servlet.MockMvc;\n\n@WebMvcTest\npublic class AttendanceBatchValidationTest {\n  @Autowired\n  MockMvc mockMvc;\n\n  @Test\n  void testMarkBatchAttendance_MissingRequiredFields_Returns400() throws Exception {\n    // Missing date\n    String jsonMissingDate = \"{\\\"subjectId\\\":\\\"SUBJ1\\\",\\\"entries\\\":[{\\\"studentId\\\":\\\"ST1\\\",\\\"present\\\":true}]}\";\n    mockMvc.perform(post(\"/api/attendance/batch\")\n        .contentType(MediaType.APPLICATION_JSON)\n        .content(jsonMissingDate))\n      .andExpect(status().isBadRequest());\n\n    // Missing subjectId\n    String jsonMissingSubject = \"{\\\"date\\\":\\\"2024-05-21\\\",\\\"entries\\\":[{\\\"studentId\\\":\\\"ST1\\\",\\\"present\\\":true}]}\";\n    mockMvc.perform(post(\"/api/attendance/batch\")\n        .contentType(MediaType.APPLICATION_JSON)\n        .content(jsonMissingSubject))\n      .andExpect(status().isBadRequest());\n  }\n\n  @Test\n  void testMarkBatchAttendance_InvalidDateFormat_Returns400() throws Exception {\n    String json = \"{\" +\n        \"\\\"date\\\":\\\"21-05-2024\\\",\\\"subjectId\\\":
```